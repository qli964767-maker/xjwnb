<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>用户账号管理系统</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/layui-src/dist/css/layui.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css">
    <style>
        body { background: #f5f5f5; padding: 15px; }
        .header-operation { display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px; }
        .search-group { display: flex; align-items: center; gap: 10px; }
        .user-table { background: #fff; border-radius: 4px; overflow: hidden; }
        .table-header { padding: 12px 15px; border-bottom: 1px solid #eee; display: flex; justify-content: space-between; }
        .status-tag { padding: 2px 8px; border-radius: 12px; font-size: 12px; }
        .status-enabled { background: #e8f5e9; color: #43a047; }
        .status-disabled { background: #ffebee; color: #e53935; }
        .avatar { width: 36px; height: 36px; border-radius: 50%; overflow: hidden; }
        .avatar img { width: 100%; height: 100%; object-fit: cover; }
    </style>
</head>
<body>
    <!-- 页面标题与操作区 -->
    <div class="header-operation">
        <h2 style="margin: 0; font-size: 16px;"><i class="fa fa-user-circle" style="color: #2196F3;"></i> 用户账号管理</h2>
        <button class="layui-btn" id="addUserBtn"><i class="fa fa-plus"></i> 新增用户</button>
    </div>

    <!-- 搜索与筛选区 -->
    <div class="layui-card" style="margin-bottom: 15px;">
        <div class="layui-card-body">
            <form class="layui-form" lay-filter="searchForm">
                <div class="search-group">
                    <div class="layui-form-item">
                        <label class="layui-form-label">用户名</label>
                        <div class="layui-input-block">
                            <input type="text" name="username" placeholder="请输入用户名" class="layui-input" style="width: 180px;">
                        </div>
                    </div>
                    
                    <div class="layui-form-item">
                        <label class="layui-form-label">手机号</label>
                        <div class="layui-input-block">
                            <input type="text" name="phone" placeholder="请输入手机号" class="layui-input" style="width: 180px;">
                        </div>
                    </div>
                    
                    <div class="layui-form-item">
                        <label class="layui-form-label">角色</label>
                        <div class="layui-input-block">
                            <select name="roleId" class="layui-select" style="width: 180px;">
                                <option value="">全部角色</option>
                                <option value="1">系统管理员</option>
                                <option value="2">库存主管</option>
                                <option value="3">仓库管理员</option>
                                <option value="4">采购专员</option>
                                <option value="5">普通员工</option>
                            </select>
                        </div>
                    </div>
                    
                    <div class="layui-form-item">
                        <label class="layui-form-label">状态</label>
                        <div class="layui-input-block">
                            <select name="status" class="layui-select" style="width: 120px;">
                                <option value="">全部状态</option>
                                <option value="1">启用</option>
                                <option value="0">禁用</option>
                            </select>
                        </div>
                    </div>
                    
                    <div class="layui-form-item">
                        <button class="layui-btn" lay-submit lay-filter="searchBtn"><i class="fa fa-search"></i> 搜索</button>
                        <button type="reset" class="layui-btn layui-btn-primary"><i class="fa fa-refresh"></i> 重置</button>
                    </div>
                </div>
            </form>
        </div>
    </div>

    <!-- 用户列表表格 -->
    <div class="user-table">
        <div class="table-header">
            <div style="font-weight: 500;">用户账号列表</div>
            <div>共 <span style="color: #2196F3;">42</span> 个用户</div>
        </div>
        <table class="layui-table" lay-size="sm" style="margin: 0;">
            <thead>
                <tr>
                    <th style="width: 50px;">ID</th>
                    <th>头像</th>
                    <th>用户名</th>
                    <th>姓名</th>
                    <th>手机号</th>
                    <th>邮箱</th>
                    <th>角色</th>
                    <th>创建时间</th>
                    <th>最后登录</th>
                    <th>状态</th>
                    <th>操作</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>1</td>
                    <td>
                        <div class="avatar">
                            <img src="https://picsum.photos/id/1/36/36" alt="用户头像">
                        </div>
                    </td>
                    <td>admin</td>
                    <td>张三</td>
                    <td>13800138000</td>
                    <td>admin@example.com</td>
                    <td>系统管理员</td>
                    <td>2023-10-15</td>
                    <td>2024-05-20 09:30</td>
                    <td><span class="status-tag status-enabled">启用</span></td>
                    <td>
                        <button class="layui-btn layui-btn-xs" id="editUser1"><i class="fa fa-edit"></i> 编辑</button>
                        <button class="layui-btn layui-btn-xs layui-btn-danger" id="deleteUser1"><i class="fa fa-trash"></i> 删除</button>
                        <button class="layui-btn layui-btn-xs layui-btn-primary" id="resetPwd1"><i class="fa fa-key"></i> 重置密码</button>
                    </td>
                </tr>
                <tr>
                    <td>2</td>
                    <td>
                        <div class="avatar">
                            <img src="https://picsum.photos/id/2/36/36" alt="用户头像">
                        </div>
                    </td>
                    <td>stock_manager</td>
                    <td>李四</td>
                    <td>13900139000</td>
                    <td>manager@example.com</td>
                    <td>库存主管</td>
                    <td>2023-10-20</td>
                    <td>2024-05-19 15:45</td>
                    <td><span class="status-tag status-enabled">启用</span></td>
                    <td>
                        <button class="layui-btn layui-btn-xs" id="editUser2"><i class="fa fa-edit"></i> 编辑</button>
                        <button class="layui-btn layui-btn-xs layui-btn-danger" id="deleteUser2"><i class="fa fa-trash"></i> 删除</button>
                        <button class="layui-btn layui-btn-xs layui-btn-primary" id="resetPwd2"><i class="fa fa-key"></i> 重置密码</button>
                    </td>
                </tr>
                <tr>
                    <td>3</td>
                    <td>
                        <div class="avatar">
                            <img src="https://picsum.photos/id/3/36/36" alt="用户头像">
                        </div>
                    </td>
                    <td>warehouse_keeper</td>
                    <td>王五</td>
                    <td>13700137000</td>
                    <td>keeper@example.com</td>
                    <td>仓库管理员</td>
                    <td>2023-11-05</td>
                    <td>2024-05-18 10:20</td>
                    <td><span class="status-tag status-enabled">启用</span></td>
                    <td>
                        <button class="layui-btn layui-btn-xs" id="editUser3"><i class="fa fa-edit"></i> 编辑</button>
                        <button class="layui-btn layui-btn-xs layui-btn-danger" id="deleteUser3"><i class="fa fa-trash"></i> 删除</button>
                        <button class="layui-btn layui-btn-xs layui-btn-primary" id="resetPwd3"><i class="fa fa-key"></i> 重置密码</button>
                    </td>
                </tr>
                <tr>
                    <td>4</td>
                    <td>
                        <div class="avatar">
                            <img src="https://picsum.photos/id/4/36/36" alt="用户头像">
                        </div>
                    </td>
                    <td>purchaser</td>
                    <td>赵六</td>
                    <td>13600136000</td>
                    <td>purchaser@example.com</td>
                    <td>采购专员</td>
                    <td>2023-11-10</td>
                    <td>2024-05-15 16:10</td>
                    <td><span class="status-tag status-disabled">禁用</span></td>
                    <td>
                        <button class="layui-btn layui-btn-xs" id="editUser4"><i class="fa fa-edit"></i> 编辑</button>
                        <button class="layui-btn layui-btn-xs layui-btn-danger" id="deleteUser4"><i class="fa fa-trash"></i> 删除</button>
                        <button class="layui-btn layui-btn-xs layui-btn-primary" id="resetPwd4"><i class="fa fa-key"></i> 重置密码</button>
                    </td>
                </tr>
            </tbody>
        </table>
        
        <!-- 分页 -->
        <div style="padding: 12px; text-align: right; border-top: 1px solid #eee;">
            <div class="layui-laypage layui-laypage-default">
                <span class="layui-laypage-count">共 42 条</span>
                <a href="#" class="layui-laypage-prev">上一页</a>
                <span class="layui-laypage-curr"><em>1</em></span>
                <a href="#">2</a>
                <a href="#">3</a>
                <a href="#">4</a>
                <a href="#">5</a>
                <span>...</span>
                <a href="#">9</a>
                <a href="#" class="layui-laypage-next">下一页</a>
            </div>
        </div>
    </div>

    <!-- 新增/编辑用户弹窗 -->
    <div id="userFormModal" style="display: none; padding: 15px;">
        <form class="layui-form" lay-filter="userForm">
            <input type="hidden" name="userId">
            
            <div class="layui-form-item">
                <label class="layui-form-label">用户名</label>
                <div class="layui-input-block">
                    <input type="text" name="username" placeholder="请输入用户名" class="layui-input" lay-verify="required|username">
                </div>
            </div>
            
            <div class="layui-form-item">
                <label class="layui-form-label">姓名</label>
                <div class="layui-input-block">
                    <input type="text" name="realName" placeholder="请输入真实姓名" class="layui-input" lay-verify="required">
                </div>
            </div>
            
            <div class="layui-form-item">
                <label class="layui-form-label">密码</label>
                <div class="layui-input-block">
                    <input type="password" name="password" placeholder="请输入密码" class="layui-input" lay-verify="required|pass" id="passwordInput">
                    <div style="margin-top: 5px; font-size: 12px; color: #666;">密码长度不少于8位，包含字母和数字</div>
                </div>
            </div>
            
            <div class="layui-form-item">
                <label class="layui-form-label">确认密码</label>
                <div class="layui-input-block">
                    <input type="password" name="confirmPassword" placeholder="请确认密码" class="layui-input" lay-verify="required|confirmPass">
                </div>
            </div>
            
            <div class="layui-form-item">
                <label class="layui-form-label">手机号</label>
                <div class="layui-input-block">
                    <input type="text" name="phone" placeholder="请输入手机号" class="layui-input" lay-verify="required|phone">
                </div>
            </div>
            
            <div class="layui-form-item">
                <label class="layui-form-label">邮箱</label>
                <div class="layui-input-block">
                    <input type="text" name="email" placeholder="请输入邮箱" class="layui-input" lay-verify="required|email">
                </div>
            </div>
            
            <div class="layui-form-item">
                <label class="layui-form-label">角色</label>
                <div class="layui-input-block">
                    <select name="roleId" lay-verify="required">
                        <option value="">请选择角色</option>
                        <option value="1">系统管理员</option>
                        <option value="2">库存主管</option>
                        <option value="3">仓库管理员</option>
                        <option value="4">采购专员</option>
                        <option value="5">普通员工</option>
                    </select>
                </div>
            </div>
            
            <div class="layui-form-item">
                <label class="layui-form-label">状态</label>
                <div class="layui-input-block">
                    <input type="radio" name="status" value="1" title="启用" checked>
                    <input type="radio" name="status" value="0" title="禁用">
                </div>
            </div>
        </form>
    </div>

    <!-- 重置密码弹窗 -->
    <div id="resetPwdModal" style="display: none; padding: 15px;">
        <form class="layui-form" lay-filter="resetPwdForm">
            <input type="hidden" name="resetUserId">
            
            <div class="layui-form-item">
                <label class="layui-form-label">新密码</label>
                <div class="layui-input-block">
                    <input type="password" name="newPassword" placeholder="请输入新密码" class="layui-input" lay-verify="required|pass">
                    <div style="margin-top: 5px; font-size: 12px; color: #666;">密码长度不少于8位，包含字母和数字</div>
                </div>
            </div>
            
            <div class="layui-form-item">
                <label class="layui-form-label">确认密码</label>
                <div class="layui-input-block">
                    <input type="password" name="confirmNewPassword" placeholder="请确认新密码" class="layui-input" lay-verify="required|confirmPass">
                </div>
            </div>
        </form>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/layui-src/dist/layui.js"></script>
    <script>
        layui.use(['form', 'layer', 'laydate'], function() {
            var form = layui.form,
                layer = layui.layer,
                laydate = layui.laydate;
            
            // 表单验证规则
            form.verify({
                username: function(value) {
                    if (value.length < 3 || value.length > 20) {
                        return '用户名长度必须在3-20个字符之间';
                    }
                    if (!/^[a-zA-Z0-9_]+$/.test(value)) {
                        return '用户名只能包含字母、数字和下划线';
                    }
                },
                pass: function(value) {
                    if (value.length < 8) {
                        return '密码长度不能少于8位';
                    }
                    if (!/^(?=.*[A-Za-z])(?=.*\d)[A-Za-z\d]{8,}$/.test(value)) {
                        return '密码必须包含字母和数字';
                    }
                },
                confirmPass: function(value) {
                    var password = $('#passwordInput').val() || $('input[name="newPassword"]').val();
                    if (value !== password) {
                        return '两次输入的密码不一致';
                    }
                }
            });
            
            // 新增用户
            $('#addUserBtn').click(function() {
                // 重置表单
                form.val('userForm', {
                    'userId': '',
                    'username': '',
                    'realName': '',
                    'password': '',
                    'confirmPassword': '',
                    'phone': '',
                    'email': '',
                    'roleId': '',
                    'status': '1'
                });
                
                // 显示密码字段（新增用户需要密码）
                $('input[name="password"]').parent().parent().show();
                $('input[name="confirmPassword"]').parent().parent().show();
                
                // 打开弹窗
                layer.open({
                    type: 1,
                    title: '新增用户',
                    area: ['600px', '500px'],
                    content: $('#userFormModal'),
                    btn: ['保存', '取消'],
                    yes: function(index) {
                        // 提交表单
                        form.on('submit(userForm)', function(data) {
                            // 模拟提交
                            layer.load(1);
                            setTimeout(function() {
                                layer.closeAll();
                                layer.msg('用户创建成功', {icon: 1});
                            }, 800);
                            return false;
                        });
                        $('#userFormModal .layui-btn-primary').click();
                    },
                    btn2: function(index) {
                        layer.close(index);
                    }
                });
            });
            
            // 编辑用户（事件委托方式绑定）
            $(document).on('click', '[id^="editUser"]', function() {
                var userId = $(this).attr('id').replace('editUser', '');
                
                // 模拟加载用户数据
                var userData = {
                    userId: userId,
                    username: 'user' + userId,
                    realName: '用户' + userId,
                    phone: '1380013800' + userId,
                    email: 'user' + userId + '@example.com',
                    roleId: userId,
                    status: '1'
                };
                
                // 填充表单
                form.val('userForm', userData);
                
                // 隐藏密码字段（编辑用户不需要密码）
                $('input[name="password"]').parent().parent().hide();
                $('input[name="confirmPassword"]').parent().parent().hide();
                
                // 打开弹窗
                layer.open({
                    type: 1,
                    title: '编辑用户',
                    area: ['600px', '420px'],
                    content: $('#userFormModal'),
                    btn: ['保存', '取消'],
                    yes: function(index) {
                        // 提交表单
                        layer.load(1);
                        setTimeout(function() {
                            layer.closeAll();
                            layer.msg('用户编辑成功', {icon: 1});
                        }, 800);
                    },
                    btn2: function(index) {
                        layer.close(index);
                    }
                });
            });
            
            // 删除用户
            $(document).on('click', '[id^="deleteUser"]', function() {
                var userId = $(this).attr('id').replace('deleteUser', '');
                
                layer.confirm('确定要删除该用户吗？', {
                    icon: 3,
                    title: '警告'
                }, function(index) {
                    // 模拟删除操作
                    layer.load(1);
                    setTimeout(function() {
                        layer.closeAll();
                        layer.msg('用户已删除', {icon: 1});
                    }, 500);
                });
            });
            
            // 重置密码
            $(document).on('click', '[id^="resetPwd"]', function() {
                var userId = $(this).attr('id').replace('resetPwd', '');
                
                // 重置表单
                form.val('resetPwdForm', {
                    'resetUserId': userId,
                    'newPassword': '',
                    'confirmNewPassword': ''
                });
                
                // 打开弹窗
                layer.open({
                    type: 1,
                    title: '重置密码',
                    area: ['500px', '300px'],
                    content: $('#resetPwdModal'),
                    btn: ['确定', '取消'],
                    yes: function(index) {
                        // 提交表单
                        layer.load(1);
                        setTimeout(function() {
                            layer.closeAll();
                            layer.msg('密码重置成功', {icon: 1});
                        }, 500);
                    },
                    btn2: function(index) {
                        layer.close(index);
                    }
                });
            });
            
            // 搜索表单提交
            form.on('submit(searchBtn)', function(data) {
                // 模拟搜索
                layer.load(1);
                setTimeout(function() {
                    layer.closeAll();
                    layer.msg('搜索完成', {icon: 1});
                }, 500);
                return false;
            });
            
            // 渲染表单
            form.render();
        });
    </script>
</body>
</html>
    